<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link href="css/widgets.css" rel="stylesheet" type="text/css"/>
        <link href="css/cards.css" rel="stylesheet" type="text/css"/>

    </head>
    <body>
        <script type="dojo/require">
            at: "dojox/mvc/at", dijit: "dijit/registry", on : "dojo/on", topic: "dojo/topic",
            $cls: "dojo/dom-class", fx: "dojox/fx/flip"
        </script>
        <div data-dojo-type="dijit/_WidgetBase" data-dojo-props="target: at(cardsMain)">
            <div id="controllers" data-dojo-type="dijit/_WidgetBase" 
                 data-dojo-props="card: at('rel:control', 'card')">
            </div>
            <div id="card" data-dojo-type="widgets/Card" 
                 data-dojo-props="content: at('rel:model.displayedCard', 'text'), controller: at('widget:controllers', 'card')">
                <script type="dojo/on" data-dojo-event="turn">
                    topic.publish("card.turn", this);
                </script>
                <script type="dojo/on" data-dojo-event="click">
                    on.emit(this, "turn", {
                        bubbles: false,
                        cancelable: false
                    });
                </script>
                <script type="dojo/method" data-dojo-event="postCreate">
                    var elem = this.domNode;
                    topic.subscribe("card.turn", function() {
                        $cls.toggle(elem, "red");
                        $cls.toggle(elem, "blue");
                        fx.flip({node: elem}).play();
                    });
                </script>
            </div>
        </div>

        <script src="dojoconfig.js" type="text/javascript"></script>
        <script 
        src="http://ajax.googleapis.com/ajax/libs/dojo/1.9.1/dojo/dojo.js" type="text/javascript"></script>

        <script type="text/javascript">
            require(["cards/main"], function(CardsMain) {
            var cardsMain = new CardsMain();
            this.cardsMain = cardsMain;
            cardsMain.start(function () {
            })
            });
        </script>
    </body>
</html>
